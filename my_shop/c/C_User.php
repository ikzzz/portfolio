<?phpinclude_once('m/M_User.php');class C_User extends C_Base{    public function action_auth(){    		$this->title .= 'Вход на сайт';    		$info = 'Введите логин и пароль';    		if($_POST){            	$user_object = new M_User();    	    	$login = $_POST['login'];    			$pass = md5($_POST['pass']);                $result = $user_object->login($login, $pass);        		if($result>0){            		setcookie("login",$login);            		setcookie("pass",$pass);                    $usersID =  $user_object->getID($login, $pass);                    $id_user = $usersID['id'];            		$getUserName = $user_object->getUser($id_user);            		$userName = $getUserName['name'];            		setcookie("userid",$id_user);            		setcookie("username",$userName);            		header("Location: index.php");        		}        		else {        		$info = '<font color="red">Неверный логин или пароль</font>';        		}        	}        	$this->content = $this->Template('v/v_auth.php', array('text' => $info));    }	public function action_logout(){		$this->title .= ' вы вышли';        setcookie("login","",time()-3600,"/");		setcookie("pass","",time()-3600,"/");		setcookie("userid","",time()-3600,"/");		setcookie("username","",time()-3600,"/");		header('Location: index.php');	}    public function action_reg(){        $this->title = ' Регистрация на сайте';        $info = "Заполните все поля";        $user_object = new M_User;        if (isset($_POST['submit']))            {             $name = trim(strip_tags($_POST['name']));             $login = trim(strip_tags($_POST['login']));             $user = $user_object->getAllUsers();             foreach ($user as $item)                 {                 if ($login == $item['login'])                    {                     exit('Такой логин уже занят!');                    }                }             if (filter_var($_POST['email'], FILTER_VALIDATE_EMAIL))                 {                 $email = trim(strip_tags($_POST['email']));                }             $pass = trim(strip_tags($_POST['pass']));             $user_object->RegUser($name, $login, $email, md5($pass));             $info = "Вы зарегистрированы!";        }        $this->content = $this->Template('v/v_reg.php', array('info' => $info));    }}